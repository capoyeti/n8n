{
  "id": "TUNp91kwMbES9Fqq",
  "name": "KM New send document flow",
  "active": true,
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1,
      "position": [
        -20,
        -20
      ],
      "id": "784437fd-6740-4afc-a569-cb23701c226c",
      "name": "Execute Workflow Trigger"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.query }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are a helpful assistant - Use the Airtable tool and Select the appropriate document to send to the user based on their input. Please analyse the input, and choose one of the below as the output. Only out the most appropriate of the below options. You must return the url for the correct document.\n\n'Fees'\n'Preschool'\n'Middle-school'\n'High-School'\n'Application'"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        380,
        -20
      ],
      "id": "f1339f7e-faf8-4a35-b6d8-5259f5b6a012",
      "name": "Document selection bot",
      "notes": "This now sends just the url for the document - how to return it to a telegram node? or whatsapp node?\nMake sure the key words map to the look up table in the database source"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        340,
        200
      ],
      "id": "1f35d66f-9d47-4a7a-92f1-e737ff162bbf",
      "name": "Groq Chat Model",
      "credentials": {
        "groqApi": {
          "id": "TeMrq8iV1WCfXr5T",
          "name": "Groq (n8n testing)"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app1FIK5puCcJqDkQ",
          "mode": "list",
          "cachedResultName": "Knynsa Montessori Documents",
          "cachedResultUrl": "https://airtable.com/app1FIK5puCcJqDkQ"
        },
        "table": {
          "__rl": true,
          "value": "tblATQiChmWaedJSQ",
          "mode": "list",
          "cachedResultName": "Public Documents",
          "cachedResultUrl": "https://airtable.com/app1FIK5puCcJqDkQ/tblATQiChmWaedJSQ"
        },
        "filterByFormula": "={Document Name} = \"{{ $fromAI('documentName') }}\"",
        "options": {
          "fields": [
            "URL"
          ]
        }
      },
      "type": "n8n-nodes-base.airtableTool",
      "typeVersion": 2.1,
      "position": [
        520,
        200
      ],
      "id": "08921fa1-d3fd-4667-ae0a-3396d62388ef",
      "name": "Airtable",
      "credentials": {
        "airtableTokenApi": {
          "id": "l4uWCVIoR9mD2u1J",
          "name": "Airtable Knysna Montessori"
        }
      },
      "notes": "connect this to the table with the mapping of the documents that you need to send to their keywords"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e6b1caba-90bc-47e5-922d-db720c933350",
              "name": "return",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        780,
        -20
      ],
      "id": "aaa7c596-f09a-4c59-8051-5b68d5942c33",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"outputParser\": {\n    \"documentName\": \"string\",\n    \"url\": \"string\"\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        700,
        200
      ],
      "id": "424a1d6f-6ee3-40da-81fd-208769d5fe2d",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "content": "## Add a timer \nhere to run every hour to check for new files?\nAnd then the file list will be 'up to date'"
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -180,
        -220
      ],
      "id": "b7b6e6f8-afd8-47b9-b622-821fb1ccbff6",
      "name": "Sticky Note"
    }
  ],
  "connections": {
    "Execute Workflow Trigger": {
      "main": [
        [
          {
            "node": "Document selection bot",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Document selection bot",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Airtable": {
      "ai_tool": [
        [
          {
            "node": "Document selection bot",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Document selection bot": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        []
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "tags": [
    {
      "updatedAt": "2024-12-12T16:16:28.430Z",
      "createdAt": "2024-12-12T16:16:28.430Z",
      "id": "44Ax1hMckPeDCwFC",
      "name": "airtable"
    },
    {
      "updatedAt": "2024-10-09T16:01:57.106Z",
      "createdAt": "2024-10-09T16:01:57.106Z",
      "id": "SNa1Vw3aUYYz8QRe",
      "name": "working"
    }
  ],
  "staticData": null,
  "meta": {},
  "pinData": {}
}